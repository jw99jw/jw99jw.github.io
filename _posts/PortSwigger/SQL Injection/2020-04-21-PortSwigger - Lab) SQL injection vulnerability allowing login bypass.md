---
layout: post
title: Lab) SQL injection vulnerability allowing login bypass
categories: [PortSwigger/SQL Injection]
tags: [SQL Injection]
---

# SQL injection vulnerability allowing login bypass
<img width="70%" src="https://user-images.githubusercontent.com/69608504/164478476-498b0601-5917-45b9-aebd-2c2f2fb7f67f.png
"/>

Second of the two apprentice level SQL injection labs.

<img width="70%" src="https://user-images.githubusercontent.com/69608504/164478932-3f28d007-820a-476f-b688-f01093a0e46d.png
"/>

### Goal : Perform an SQL injection and log in as the administrator user.

According to the description, there is a known SQL injection vulnerability in the login function. 

To check this out, let's see how the login function works.

Try entering ' in the username parameter and any arbitrary value in the password parameter. 

<img width="70%" src="https://user-images.githubusercontent.com/69608504/164480425-d16509f5-52c0-48e0-bd6b-a435b217a80b.png
"/>

Internal Server Error is shown. This means that the value we entered caused error, because the login function doesn't validate the user's inputs correctly, leading to SQL injection vulnerability.

As shown in the description, let's try administrator.

<img width="70%" src="https://user-images.githubusercontent.com/69608504/164481676-a75ebe9c-a410-44bf-83b0-7ce8f90e0755.png
"/>

Since anything behind the administrator is commented out, you can enter any value in the password. 

Let's take a look at the query.

The query we just entered should look like this:

SELECT * FROM [SOME DATABASE] WHERE username='administrator'-- and password='somerandominput'

And the query the application recognizes will look like this:

SELECT * FROM [SOME DATABASE] WHERE username='administrator'

Since there is no any other validation, the application will let you log in as the administrator.

<img width="70%" src="https://user-images.githubusercontent.com/69608504/164482494-998cda50-01bf-4039-bda4-6ecb5df0e6d9.png
"/>
